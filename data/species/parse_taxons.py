species_mapping = {
    'Acratocnus sp.' : 'Acratocnus',
    'Actinobacillus pleuropneumoniae serotype 3' : 'Actinobacillus pleuropneumoniae',
    'Actinobacillus pleuropneumoniae serotype 5b' : 'Actinobacillus pleuropneumoniae',
    'Avian leukosis virus RSA' : 'Avian leukosis virus',
    'Azobacteroides pseudotrichonymphae genomovar. CFP2' : 'Azobacteroides pseudotrichonymphae',
    'Bat coronavirus 133/2005' : 'Bat coronavirus',
    'Bat coronavirus 279/2005' : 'Bat coronavirus',
    'Bat coronavirus Rp3/2004' : 'Bat coronavirus',
    'Baumannia cicadellinicola subsp. Homalodisca coagulata' : 'Baumannia cicadellinicola',
    'Bovine adenovirus B serotype 3' : 'Bovine adenovirus B',
    'Bovine herpesvirus 1.2' : 'Bovine alphaherpesvirus 1',
    'Brucella melitensis biotype 1' : 'Brucella melitensis',
    'Buchnera aphidicola subsp. Acyrthosiphon pisum' : 'Buchnera aphidicola',
    'Campylobacter jejuni subsp. jejuni serotype O:2' : 'Campylobacter jejuni',
    'Campylobacter jejuni subsp. jejuni serotype O:23/36' : 'Campylobacter jejuni',
    'Campylobacter jejuni subsp. jejuni serotype O:6' : 'Campylobacter jejuni',
    'Canine adenovirus serotype 1' : 'Canine adenovirus',
    'Chimpanzee hepatitis B virus' : 'hepatitis B virus',
    'Chlamydia trachomatis serovar A' : 'Chlamydia trachomatis',
    'Chlamydia trachomatis serovar L2' : 'Chlamydia trachomatis',
    'Chlamydia trachomatis serovar L2b' : 'Chlamydia trachomatis',
    'Cryptococcus neoformans var. grubii serotype A' : 'Cryptococcus neoformans',
    'Cryptococcus neoformans var. neoformans serotype D' : 'Cryptococcus neoformans',
    'Equus sp' : 'Equus',
    'Escherichia coli O17:K52:H18' : 'Escherichia coli',
    'Escherichia coli O1:K1 / APEC' : 'Escherichia coli',
    'Escherichia coli O6:H1' : 'Escherichia coli',
    'Escherichia coli O6:K15:H31' : 'Escherichia coli',
    'Escherichia coli O81' : 'Escherichia coli',
    'Escherichia coli O9:H4' : 'Escherichia coli',
    'Fowl adenovirus A serotype 1' : 'Fowl adenovirus A',
    'Fowl adenovirus C serotype 10' : 'Fowl adenovirus C',
    'Gibbon hepatitis B virus subtype ayw3q' : 'hepatitis B virus',
    'Glaesserella parasuis serovar 5' : 'Glaesserella parasuis',
    'Glyptodon sp.' : 'Glyptodon',
    'Hamiltonella defensa subsp. Acyrthosiphon pisum' : 'Hamiltonella defensa',
    'Hepatitis B virus genotype A1 subtype adw' : 'Hepatitis B virus',
    'Hepatitis B virus genotype A1 subtype adw2' : 'Hepatitis B virus',
    'Hepatitis B virus genotype A2 subtype adw' : 'Hepatitis B virus',
    'Hepatitis B virus genotype A2 subtype adw2' : 'Hepatitis B virus',
    'Hepatitis B virus genotype A2' : 'Hepatitis B virus',
    'Hepatitis B virus genotype A3' : 'Hepatitis B virus',
    'Hepatitis B virus genotype B/C subtype adw' : 'Hepatitis B virus',
    'Hepatitis B virus genotype B1 subtype adw' : 'Hepatitis B virus',
    'Hepatitis B virus genotype B1' : 'Hepatitis B virus',
    'Hepatitis B virus genotype B2 subtype adw' : 'Hepatitis B virus',
    'Hepatitis B virus genotype B2' : 'Hepatitis B virus',
    'Hepatitis B virus genotype C subtype ad' : 'Hepatitis B virus',
    'Hepatitis B virus genotype C subtype adr' : 'Hepatitis B virus',
    'Hepatitis B virus genotype C subtype ar' : 'Hepatitis B virus',
    'Hepatitis B virus genotype C subtype ayw' : 'Hepatitis B virus',
    'Hepatitis B virus genotype D subtype adw' : 'Hepatitis B virus',
    'Hepatitis B virus genotype D subtype ayw' : 'Hepatitis B virus',
    'Hepatitis B virus genotype F2 subtype adw4q' : 'Hepatitis B virus',
    'Hepatitis B virus genotype F2' : 'Hepatitis B virus',
    'Hepatitis B virus genotype G subtype adw2' : 'Hepatitis B virus',
    'Hepatitis B virus genotype H subtype adw4' : 'Hepatitis B virus',
    'Hepatitis C virus genotype 1c' : 'Hepatitis C virus',
    'Hepatitis C virus genotype 2a' : 'Hepatitis C virus',
    'Hepatitis C virus genotype 2b' : 'Hepatitis C virus',
    'Hepatitis C virus genotype 2c' : 'Hepatitis C virus',
    'Hepatitis C virus genotype 2k' : 'Hepatitis C virus',
    'Hepatitis C virus genotype 3b' : 'Hepatitis C virus',
    'Hepatitis C virus genotype 3k' : 'Hepatitis C virus',
    'Hepatitis C virus genotype 4a' : 'Hepatitis C virus',
    'Hepatitis C virus genotype 5a' : 'Hepatitis C virus',
    'Hepatitis C virus genotype 6a' : 'Hepatitis C virus',
    'Hepatitis C virus genotype 6b' : 'Hepatitis C virus',
    'Hepatitis C virus genotype 6d' : 'Hepatitis C virus',
    'Hepatitis C virus genotype 6g' : 'Hepatitis C virus',
    'Hepatitis C virus genotype 6h' : 'Hepatitis C virus',
    'Hepatitis C virus genotype 6k' : 'Hepatitis C virus',
    'Hepatitis E virus genotype 1' : 'Hepatitis E virus',
    'Hepatitis delta virus genotype I' : 'Hepatitis delta virus',
    'Hepatitis delta virus genotype II' : 'Hepatitis delta virus',
    'Hepatitis delta virus genotype III' : 'Hepatitis delta virus',
    'Hortulanus murine leukemia virus' : 'murine leukemia virus',
    'Human T-cell leukemia virus 1' : 'Human T-cell leukemia virus type I',
    'Human T-cell leukemia virus 2' : 'Human T-lymphotropic virus 2',
    'Human T-cell leukemia virus 3' : 'Primate T-lymphotropic virus 3',
    'Human adenovirus A serotype 12' : 'Human adenovirus A',
    'Human adenovirus B serotype 16' : 'Human adenovirus B',
    'Human adenovirus B serotype 3' : 'Human adenovirus B',
    'Human adenovirus B serotype 7' : 'Human adenovirus B',
    'Human adenovirus C serotype 2' : 'Human adenovirus C',
    'Human adenovirus C serotype 5' : 'Human adenovirus C',
    'Human adenovirus D serotype 9' : 'Human adenovirus D',
    'Human adenovirus E serotype 4' : 'Human adenovirus E',
    'Human adenovirus F serotype 40' : 'Human adenovirus F',
    'Human adenovirus F serotype 41' : 'Human adenovirus F',
    'Human immunodeficiency virus type 1 group M subtype A' : 'Human immunodeficiency virus type 1',
    'Human immunodeficiency virus type 1 group M subtype B' : 'Human immunodeficiency virus type 1',
    'Human immunodeficiency virus type 1 group M subtype C' : 'Human immunodeficiency virus type 1',
    'Human immunodeficiency virus type 1 group M subtype D' : 'Human immunodeficiency virus type 1',
    'Human immunodeficiency virus type 1 group M subtype F1' : 'Human immunodeficiency virus type 1',
    'Human immunodeficiency virus type 1 group M subtype F2' : 'Human immunodeficiency virus type 1',
    'Human immunodeficiency virus type 1 group M subtype G' : 'Human immunodeficiency virus type 1',
    'Human immunodeficiency virus type 1 group M subtype H' : 'Human immunodeficiency virus type 1',
    'Human immunodeficiency virus type 1 group M subtype J' : 'Human immunodeficiency virus type 1',
    'Human immunodeficiency virus type 1 group M subtype K' : 'Human immunodeficiency virus type 1',
    'Human immunodeficiency virus type 1 group M subtype U' : 'Human immunodeficiency virus type 1',
    'Human immunodeficiency virus type 1 group N' : 'Human immunodeficiency virus type 1',
    'Human immunodeficiency virus type 1 group O' : 'Human immunodeficiency virus type 1',
    'Human immunodeficiency virus type 2 subtype A' : 'Human immunodeficiency virus type 2',
    'Human immunodeficiency virus type 2 subtype B' : 'Human immunodeficiency virus type 2',
    'Human papillomavirus type 1' : 'Human papillomavirus',
    'Leptospira interrogans serogroup Icterohaemorrhagiae serovar Lai' : 'Leptospira interrogans',
    'Leptospira interrogans serogroup Icterohaemorrhagiae serovar copenhageni' : 'Leptospira interrogans',
    'Listeria innocua serovar 6a' : 'Listeria innocua',
    'Listeria monocytogenes serovar 1/2a' : 'Listeria monocytogenes',
    'Listeria welshimeri serovar 6b' : 'Listeria welshimeri',
    'Macrauchenia sp' : 'Macrauchenia',
    'Methylovorus sp.' : 'Methylovorus',
    'Murine adenovirus A serotype 1' : 'Murine adenovirus A',
    'Mycolicibacterium paratuberculosis' : 'Mycobacterium paratuberculosis',
    'Neisseria meningitidis serogroup A / serotype 4A' : 'Neisseria meningitidis',
    'Neisseria meningitidis serogroup C / serotype 2a' : 'Neisseria meningitidis',
    'Pediculus humanus subsp. corporis' : 'Pediculus humanus',
    'Porcine adenovirus A serotype 3' : 'Porcine adenovirus A',
    'Porcine adenovirus B serotype 4' : 'Porcine adenovirus B',
    'Rodentia sp' : 'Rodentia',
    'Ruthia magnifica subsp. Calyptogena magnifica' : 'Ruthia magnifica',
    'SARSCoV1' : 'Severe acute respiratory syndrome coronavirus',
    'SARSCoV2' : 'Severe acute respiratory syndrome coronavirus 2',
    'Salmonella enteritidis PT4' : 'Salmonella enteritidis',
    'Scelidodon sp.' : 'Scelidodon',
    'Scelidotherium sp.' : 'Scelidotherium',
    'Scenedesmus fuscus' : 'Scenedesmus',
    'Shigella boydii serotype 4' : 'Shigella boydii',
    'Shigella dysenteriae serotype 1' : 'Shigella dysenteriae',
    'Shigella flexneri serotype 5b' : 'Shigella flexneri',
    'Simian immunodeficiency virus AGM.tantalus' : 'Simian immunodeficiency virus',
    'Simian immunodeficiency virus agm.grivet' : 'Simian immunodeficiency virus',
    'Simian immunodeficiency virus agm.vervet' : 'Simian immunodeficiency virus',
    'Snake adenovirus serotype 1' : 'Snake adenovirus 1',
    'Streptococcus pneumoniae serotype 19F' : 'Streptococcus pneumoniae',
    'Streptococcus pneumoniae serotype 2' : 'Streptococcus pneumoniae',
    'Tick-borne encephalitis virus European subtype' : 'Tick-borne encephalitis virus',
    'Tick-borne encephalitis virus Far Eastern subtype' : 'Tick-borne encephalitis virus',
    'Tick-borne powassan virus' : 'Tick-borne virus',
    'Toxodon sp' : 'Toxodon',
    'Vesicomyosocius okutanii subsp. Calyptogena okutanii' : 'Vesicomyosocius okutanii',
    'Vibrio cholerae serotype O1' : 'Vibrio cholerae',
    'Vibrio parahaemolyticus serotype O3:K6' : 'Vibrio parahaemolyticus',
    'Wolbachia pipientis subsp. Culex pipiens' : 'Wolbachia pipientis',
    'Wolbachia sp. subsp. Brugia malayi' : 'Wolbachia',
    'Wolbachia sp. subsp. Drosophila simulans' : 'Wolbachia',
    'Yersinia enterocolitica serotype O:8 / biotype 1B' : 'Yersinia enterocolitica',
    'Yersinia pestis bv. Antiqua' : 'Yersinia pestis',
    'Yersinia pseudotuberculosis serotype I' : 'Yersinia pseudotuberculosis',
    'Yersinia pseudotuberculosis serotype O:1b' : 'Yersinia pseudotuberculosis',
    'Yersinia pseudotuberculosis serotype O:3' : 'Yersinia pseudotuberculosis',
    'marmoset' : 'Callithrix jacchus'
}


# spe_re_file = open('species_re.txt', 'w')
# with open('species.txt', 'r') as spe_file:
#     for line in spe_file:
#         spe_re_file.write(species_mapping.get(line.strip(), line.strip()) + '\n')

# spe_re_file.close()

# input('Input "species_re.txt" to NCBI, update "raw_taxons.txt" and hit enter!')


IDs = {}
with open('raw_taxons_re.txt', 'r') as taxons_file:
    for line in taxons_file:
        line_ = [i.strip() for i in line.split('|')]
        code, name, pref_name, ID = line_
        if not ID:
            species_mapping[name] = 'NA'
            IDs[name] = 'NA'

        if ID:
            if pref_name:
                if name in species_mapping.values():
                    for old in species_mapping.keys():
                        if species_mapping[old] == name:
                            species_mapping[old] = pref_name
                else:
                    species_mapping[name] = pref_name
                IDs[name] = ID

                species_mapping[pref_name] = pref_name
                IDs[pref_name] = ID

            else:
                species_mapping[name] = name
                IDs[name] = ID
            


with open('species_mapping.tsv', 'w') as outfile:
    for name in sorted(species_mapping.keys()):
        pref_name = species_mapping.get(name)
        ID = IDs.get(pref_name)
        #print(f"\t'{name}' : '',")
        outfile.write(f'{name}\t{pref_name}\t{ID}\n')

for i in sorted(set(species_mapping.values())):
    print(i)